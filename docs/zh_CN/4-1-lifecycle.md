# 生命周期

由于 FastD 是可运行在 FPM 和 Swoole 之上，在 FPM 运行环境下，生命周期与普通的 PHP 是一致的。

而那么在 Swoole 运行环境当中，则是运行在内存当中，常规的 PHP 开发者都没有很好的内存进行清理管理，所以若是运行在 Swoole 环境上，则需要对无用的数据进行清理，对异常进行处理，清除 exit/die 等操作。

### 启动/引导

当应用启动 `bootstrap` 方法是，程序正式进入初始化阶段，将核心服务，配置注册到容器(应用)当中.

1. 加载应用配置
2. 注册系统服务与自定义服务
3. 加载路由
4. 标记已引导

### 请求

当应用接收到用户请求，会先通过 Http 组件进行处理，然后传递到路由调度器中进行调度处理。

1. 接收请求
2. 匹配路由
3. 处理中间件
4. 返回处理

### 响应

处理完请求后，应用接收返回，通过处理检验包装后，返回给客户端。

1. 接收处理返回
2. 返回客户端(输出)

### 退出

在 FPM 模式下，当应用响应完成后，FPM 会自动清理或重置所有信息，而在 Swoole 运行环境下，则会将部分一次性数据进行重置，内部逻辑则不会进行清理，因此需要在逻辑处理中进行数据清理。

1. 清理数据
2. 日志记录

# 架构与理念

提供一个主干，让开发者灵活拆卸零件(ServiceProvider)，让项目，功能更加独立和灵活。

下一节: [RPC服务](4-2-microservice.md)
